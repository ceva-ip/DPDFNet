import torch


class InitErbNorm:
    """Dataclass for ERB normalization initialization parameters."""

    def __init__(self):
        self.low_val = -60.0
        self.high_val = -90.0
    
    def get_heiuristic_mu_0(self, num_feat: int = 32):
        step = (self.high_val - self.low_val) / (num_feat - 1)
        mu_0 = self.low_val + torch.arange(num_feat) * step
        return mu_0
    
    def get_ampirical_mu_0(self):
        raise NotImplementedError("Empirical mu_0 initialization not implemented yet.")



class InitMagNorm:
    """Dataclass for Magnitude normalization initialization parameters."""

    def __init__(self):
        self.low_val = -60.0
        self.high_val = -90.0
    
    def get_heiuristic_mu_0(self, num_feat: int = 481):
        step = (self.high_val - self.low_val) / (num_feat - 1)
        mu_0 = self.low_val + torch.arange(num_feat) * step
        return mu_0
    
    def get_ampirical_mu_0(self, num_feat: int = 481):
        mu_0 = torch.tensor([
            -32.5573, -34.8212, -38.8536, -39.8786, -40.7435, -41.5264, -42.2550,
            -42.4084, -42.4310, -42.6460, -43.0335, -43.6704, -44.5702, -45.3495,
            -46.0085, -46.4555, -46.6586, -46.5344, -46.6155, -46.8084, -46.9929,
            -47.1601, -47.2527, -47.3922, -47.6403, -47.9241, -48.1503, -48.3009,
            -48.2301, -48.3322, -48.7560, -48.9983, -48.9335, -48.9662, -49.1459,
            -49.3420, -49.7211, -50.0116, -49.9385, -49.9582, -50.2630, -50.5991,
            -50.6968, -50.6802, -50.6985, -50.7848, -51.0159, -51.2049, -51.1635,
            -51.1143, -51.2253, -51.3587, -51.4638, -51.6249, -51.6959, -51.6421,
            -51.7896, -52.1039, -52.2228, -52.2449, -52.3748, -52.4833, -52.6428,
            -52.8336, -52.9246, -52.9568, -53.0166, -53.0936, -53.2231, -53.3220,
            -53.2919, -53.2598, -53.3251, -53.4057, -53.4346, -53.4701, -53.5049,
            -53.5446, -53.6280, -53.7321, -53.8563, -53.9212, -53.9847, -54.0431,
            -54.2167, -54.4016, -54.4896, -54.5848, -54.6639, -54.7624, -54.9358,
            -55.1197, -55.2275, -55.3156, -55.4165, -55.5399, -55.6764, -55.7395,
            -55.7477, -55.8479, -55.9744, -56.0430, -56.0860, -56.1640, -56.2363,
            -56.2628, -56.3778, -56.4760, -56.5116, -56.5653, -56.6614, -56.7072,
            -56.7463, -56.8341, -56.8720, -56.9147, -56.9865, -57.0185, -57.0088,
            -57.0422, -57.1057, -57.1574, -57.1939, -57.2076, -57.2134, -57.2274,
            -57.2744, -57.3180, -57.2798, -57.3123, -57.3425, -57.3012, -57.2734,
            -57.2837, -57.2924, -57.2481, -57.2324, -57.2853, -57.2801, -57.2275,
            -57.2241, -57.2267, -57.2223, -57.2299, -57.2213, -57.1935, -57.2167,
            -57.2694, -57.2692, -57.2359, -57.2661, -57.2832, -57.2845, -57.2923,
            -57.3002, -57.3082, -57.2977, -57.3481, -57.3689, -57.3640, -57.3757,
            -57.4232, -57.4438, -57.4617, -57.5147, -57.5294, -57.5081, -57.5383,
            -57.5932, -57.5671, -57.5515, -57.5581, -57.5631, -57.5515, -57.5555,
            -57.5938, -57.6046, -57.6050, -57.6177, -57.6236, -57.6322, -57.6557,
            -57.7025, -57.7337, -57.7679, -57.8210, -57.8595, -57.8640, -57.8880,
            -57.9267, -57.9714, -57.9995, -58.0165, -58.0381, -58.0720, -58.1155,
            -58.1525, -58.1538, -58.1753, -58.2077, -58.2278, -58.2362, -58.2209,
            -58.2060, -58.2296, -58.2728, -58.3094, -58.3506, -58.3813, -58.4140,
            -58.4446, -58.4497, -58.4721, -58.4972, -58.5253, -58.5301, -58.5328,
            -58.5627, -58.5960, -58.6233, -58.6604, -58.7172, -58.7706, -58.8209,
            -58.8839, -58.9435, -59.0027, -59.0626, -59.1240, -59.2068, -59.2783,
            -59.3370, -59.4002, -59.4317, -59.4730, -59.4850, -59.5219, -59.5662,
            -59.5398, -59.5387, -59.5882, -59.6119, -59.6049, -59.6075, -59.6520,
            -59.6765, -59.6948, -59.7326, -59.7967, -59.8499, -59.9053, -59.9388,
            -60.0229, -60.0928, -60.1238, -60.1692, -60.2615, -60.3149, -60.3411,
            -60.4097, -60.4845, -60.5007, -60.5397, -60.6091, -60.6559, -60.6968,
            -60.7423, -60.8142, -60.8643, -60.9090, -60.9342, -60.9754, -61.0166,
            -61.0444, -61.0889, -61.1499, -61.1811, -61.2334, -61.2779, -61.3123,
            -61.3728, -61.4356, -61.4621, -61.5222, -61.5875, -61.6326, -61.6533,
            -61.7240, -61.7653, -61.7825, -61.8327, -61.8723, -61.9088, -61.9167,
            -61.9362, -62.0017, -62.0458, -62.0655, -62.0833, -62.1180, -62.1346,
            -62.1610, -62.1685, -62.2173, -62.2716, -62.3036, -62.3412, -62.3841,
            -62.4318, -62.4740, -62.5171, -62.5457, -62.5202, -62.6277, -62.7108,
            -62.7737, -62.8414, -62.8911, -62.9369, -62.9722, -62.9966, -63.0276,
            -63.0892, -63.1491, -63.1747, -63.2264, -63.2771, -63.2967, -63.3073,
            -63.3486, -63.3913, -63.4314, -63.4603, -63.4844, -63.5416, -63.5944,
            -63.6229, -63.6585, -63.7060, -63.7358, -63.7645, -63.7970, -63.8262,
            -63.8632, -63.9072, -63.9406, -63.9934, -64.0589, -64.0916, -64.1281,
            -64.1837, -64.2363, -64.2770, -64.2934, -64.3225, -64.3868, -64.4234,
            -64.4573, -64.4972, -64.5551, -64.5868, -64.6233, -64.6848, -64.7299,
            -64.7550, -64.8106, -64.8852, -64.9567, -65.0360, -65.0945, -65.1731,
            -65.2444, -65.2855, -65.3231, -65.3765, -65.4467, -65.5100, -65.5836,
            -65.6743, -65.7611, -65.8354, -65.8935, -65.9761, -66.0545, -66.1244,
            -66.1970, -66.2874, -66.3671, -66.4253, -66.4988, -66.5822, -66.6647,
            -66.7598, -66.8443, -66.9459, -67.0204, -67.1024, -67.1904, -67.2890,
            -67.3920, -67.4990, -67.6560, -67.7912, -67.8871, -67.9999, -68.1219,
            -68.2043, -68.2933, -68.3826, -68.4811, -68.6007, -68.7119, -68.8221,
            -68.9302, -69.0493, -69.1750, -69.2771, -69.3844, -69.4990, -69.6036,
            -69.7136, -69.8386, -69.9523, -70.0628, -70.1746, -70.2902, -70.3978,
            -70.4796, -70.5335, -70.5189, -70.4241, -70.2812, -70.1093, -70.0510,
            -70.1993, -70.3491, -70.5081, -70.7476, -71.0036, -71.2459, -71.5072,
            -71.7031, -71.9048, -72.1479, -72.3301, -72.6034, -72.8438, -73.2156,
            -73.5853, -73.7625, -74.0639, -74.5064, -74.9360, -75.3742, -75.7763,
            -76.1246, -76.4624, -76.7765, -77.1317, -77.5190, -77.8954, -78.2606,
            -78.6848, -79.1475, -79.6327, -80.1251, -80.6212, -81.1785, -81.7839,
            -82.3960, -83.0165, -83.6428, -84.2644, -84.9417, -85.6693, -86.3048,
            -86.8885, -87.5031, -88.1544, -88.7786, -90.1860])
        assert mu_0.shape[0] >= num_feat, "Empirical mu_0 has fewer features than requested."
        return mu_0[:num_feat]


class InitSpecNorm:
    """Dataclass for ComplexSpec normalization initialization parameters."""

    def __init__(self):
        self.low_val = 0.001
        self.high_val = 0.0001
    
    def get_heiuristic_s_0(self, num_feat: int = 96):
        step = (self.high_val - self.low_val) / (num_feat - 1)
        s_0 = self.low_val + torch.arange(num_feat) * step
        return s_0
    
    def get_ampirical_s_0(self, num_feat: int = 96):
        s_0 = torch.tensor([
            4.7844e-03, 2.3145e-03, 1.1381e-03, 1.3410e-03, 1.6284e-03, 1.3601e-03,
            1.0599e-03, 1.0851e-03, 1.1904e-03, 1.1748e-03, 1.1158e-03, 9.9944e-04,
            8.1417e-04, 6.7053e-04, 5.5371e-04, 4.8805e-04, 4.4805e-04, 4.4902e-04,
            4.4367e-04, 4.1298e-04, 3.9242e-04, 3.8549e-04, 3.8750e-04, 3.8644e-04,
            3.6546e-04, 3.3962e-04, 3.1683e-04, 3.0448e-04, 3.0708e-04, 2.9747e-04,
            2.6569e-04, 2.4229e-04, 2.4168e-04, 2.3999e-04, 2.2739e-04, 2.1208e-04,
            1.8911e-04, 1.7261e-04, 1.7518e-04, 1.7160e-04, 1.5553e-04, 1.4251e-04,
            1.3752e-04, 1.3577e-04, 1.3799e-04, 1.3612e-04, 1.2774e-04, 1.2313e-04,
            1.2493e-04, 1.2583e-04, 1.2150e-04, 1.1667e-04, 1.1219e-04, 1.0793e-04,
            1.0796e-04, 1.1019e-04, 1.0533e-04, 9.5074e-05, 9.1160e-05, 9.1670e-05,
            8.8261e-05, 8.5424e-05, 8.1251e-05, 7.6537e-05, 7.5368e-05, 7.4621e-05,
            7.3294e-05, 7.2258e-05, 7.0843e-05, 6.9355e-05, 6.9455e-05, 7.0497e-05,
            6.9709e-05, 6.8114e-05, 6.9217e-05, 6.9024e-05, 6.7724e-05, 6.7785e-05,
            6.7715e-05, 6.6654e-05, 6.4153e-05, 6.2390e-05, 6.1973e-05, 6.1699e-05,
            6.0428e-05, 5.8661e-05, 5.7287e-05, 5.5862e-05, 5.5363e-05, 5.4702e-05,
            5.2889e-05, 4.9619e-05, 4.8314e-05, 4.7766e-05, 4.6633e-05, 4.5958e-05])
        assert s_0.shape[0] >= num_feat, "Empirical s_0 has fewer features than requested."
        return s_0[:num_feat]



